flowchart LR
    %% Actors
    User((User))
    Partner((Partner))

    %% Client Side
    subgraph Client ["üì± Client Device (React Native)"]
        direction TB
        UI[UI / Screens]
        State["State Mgmt<br/>(Zustand)"]
        LocalDB[("AsyncStorage<br/>Encrypted")]
        Camera[Camera Module]
    end

    %% Backend Side
    subgraph Cloud ["‚òÅÔ∏è Firebase Cloud Backend"]
        direction TB
        Auth[Authentication]
        Trigger[Cloud Functions]
        FCM[Cloud Messaging]
        
        subgraph Data ["Data Layer"]
            Firestore[("Firestore<br/>NoSQL")]
            Storage[("Storage<br/>Media Buckets")]
        end
    end

    %% Flows being distinct
    User -->|1. Open App| UI
    UI -->|2. Capture| Camera
    Camera -->|3. Process| UI
    UI <-->|4. Sync State| State
    State <-->|5. Cache| LocalDB

    %% Network Calls
    UI <-->|6. Auth Token| Auth
    UI -->|7. Upload Media| Storage
    UI <-->|8. Sync Data| Firestore

    %% Async & Notification Flow
    Firestore -.->|9. Trigger| Trigger
    Trigger -.->|10. Push Notification| FCM
    FCM -.->|11. Wake/Alert| Partner
    Partner -->|12. View Content| UI

    %% Styling to mimic clean technical diagrams
    classDef actor fill:#333,stroke:#333,color:#fff;
    classDef client fill:#e3f2fd,stroke:#1565c0,stroke-width:2px;
    classDef cloud fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,stroke-dasharray: 5 5;
    classDef data fill:#fff3e0,stroke:#e65100,stroke-width:2px;

    class User,Partner actor;
    class UI,State,Camera,LocalDB client;
    class Auth,Trigger,FCM cloud;
    class Firestore,Storage data;
